# Index


由于笔者太懒,加之本文主要是为方便回顾流程所写,只会在一些笔者遇到的问题上详细说明,不会像参考链接中的大多数博客那样详细,orz

&lt;!--more--&gt; 

## 1.VSCode搭建C&#43;&#43;开发环境

大学里其实没怎么认真配过VSCode开发环境, 以前写.c基本都是单文件的习题小练习, 跟着网上教程走一遍, 后面不怎么写了

现在是需要用C&#43;&#43;的三方库了, 回来配一下环境, 顺便熟悉一下C&#43;&#43;, 以后上班八成要用


### 1.1前置准备

参见[GCC on Windows](https://code.visualstudio.com/docs/cpp/config-mingw), 按照步骤来就行, 可以与中文博客对照

主要就是安装VSCode, 安装MinGW(GCC在Windows上的版本), 安装VSCode的C/C&#43;&#43;插件

### 1.2问题

事情一直到单文件编译调试都很顺利

这里先提一下VSCode是如何构建C&#43;&#43;开发流程的:

我们知道,VSC只是集成了一下GCC和GDB罢了,免去了你在命令行手动编译,链接的过程

博客一般都会提到初次build时,会提示你选择compiler(gcc, g&#43;&#43;, Clang等), 然后自动生成`.vscode/tasks.json`

形如
```json
{
  &#34;tasks&#34;: [
    {
      &#34;type&#34;: &#34;cppbuild&#34;,
      &#34;label&#34;: &#34;C/C&#43;&#43;: g&#43;&#43;.exe build active file&#34;,
      &#34;command&#34;: &#34;C:\\msys64\\ucrt64\\bin\\g&#43;&#43;.exe&#34;,
      &#34;args&#34;: [
        &#34;-fdiagnostics-color=always&#34;,
        &#34;-g&#34;,
        &#34;${file}&#34;,
        &#34;-o&#34;,
        &#34;${fileDirname}\\${fileBasenameNoExtension}.exe&#34;
      ],
      &#34;options&#34;: {
        &#34;cwd&#34;: &#34;${fileDirname}&#34;
      },
      &#34;problemMatcher&#34;: [&#34;$gcc&#34;],
      &#34;group&#34;: {
        &#34;kind&#34;: &#34;build&#34;,
        &#34;isDefault&#34;: true
      },
      &#34;detail&#34;: &#34;Task generated by Debugger.&#34;
    }
  ],
  &#34;version&#34;: &#34;2.0.0&#34;
}

```
不难看出,这就类似一个脚本配置,设定好cmd和args,再自动build .cpp文件

自然的,要编译链接多文件,做一点小小改动即可...吗?

本来该是这样的 orz

```json
{
    &#34;version&#34;: &#34;2.0.0&#34;,
    &#34;tasks&#34;: [
        {
            &#34;type&#34;: &#34;cppbuild&#34;,
            //&#34;type&#34;: &#34;shell&#34;,
            &#34;label&#34;: &#34;GCC Compiler&#34;,
            &#34;command&#34;: &#34;C:\\msys64\\ucrt64\\bin\\gcc.exe&#34;,
            &#34;shell&#34;: { 
                &#34;executable&#34;: &#34;powershell.exe&#34;
            },
            &#34;args&#34;: [
                &#34;-fdiagnostics-color=always&#34;,
                &#34;-g&#34;,
                //&#34;${file}&#34;,
                &#34;${workspaceFolder}\\*.cpp&#34;,
                &#34;-o&#34;,
                //&#34;${fileDirname}\\${fileBasenameNoExtension}.exe&#34;
                &#34;${workspaceFolder}\\AnyNameYouLike.exe&#34;
            ],
            &#34;options&#34;: {
                &#34;cwd&#34;: &#34;${workspaceFolder}&#34;
            },
            &#34;problemMatcher&#34;: [
                &#34;$gcc&#34;
            ],
            &#34;group&#34;: &#34;build&#34;,
            &#34;detail&#34;: &#34;compiler: C:\\msys64\\ucrt64\\bin\\gcc.exe&#34;
        },
    ]
}

```
我们用通配符指定所有.cpp文件,这部就大功告成了?

然而实际build时会报错

```bash
 *  Executing task: GCC Compiler 

Starting build...
cmd /c chcp 65001&gt;nul &amp;&amp; C:\msys64\ucrt64\bin\gcc.exe -fdiagnostics-color=always -g C:\Users\fengjin\cppenv\*.cpp -o C:\Users\fengjin\cppenv\test.exe
cc1plus.exe: fatal error: C:\Users\fengjin\cppenv\*.cpp: Invalid argument
compilation terminated.

Build finished with error(s).

 *  The terminal process failed to launch (exit code: -1). 
 *  Terminal will be reused by tasks, press any key to close it. 
```
这个通配符`*`真的就以`*`的形式出现在命令里了,没有展开

为了解决这个问题,我在国内外疯狂检索,狠狠拷打AI,然而没有令人信服的方案

一是出现这个bug很少; 

二来少有的回复或者无法解决,或者直接建议别用睿智tasks.json弄多文件了,直接上CMake/VS

记录一下我尝试过的方法:
1. 使用不同形式的通配符: `//*.cpp` , `//**.cpp`, `\*.cpp`, `\\*.cpp`
2. 修改`type`属性为`shell`
3. 修改`command`属性为先调pwsh.exe,再拼接gcc编译
4. 修改`command`的编译器为`g&#43;&#43;`, 同时修改C/C&#43;&#43;插件的设置`c_cpp_properties.json`, `compilerPath`也改成`g&#43;&#43;`

...都不行orz


## 2.CMake

人不能在一棵树上吊死, 既然还有其他多文件编译的方案, 先去试试

### 2.1前置准备




## 3.VSCode &#43; WSL




## 参考链接



---

> 作者: Kissy  
> URL: http://localhost:1313/posts/index/  

